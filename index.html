<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>台灣小吃店 - LINE 快速訂餐</title>

    <!-- Vercel 環境變數注入點 -->
    <meta name="liff-id" content="%NEXT_PUBLIC_LIFF_ID%" />
    <meta name="api-endpoint" content="%NEXT_PUBLIC_API_ENDPOINT%" />

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        /* ... 你的 CSS ... */
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useCallback, useEffect, useMemo } = React;

        // 安全從 meta 標籤讀取
        const getMeta = (name) => {
            const meta = document.querySelector(`meta[name="${name}"]`);
            return meta ? meta.getAttribute('content') : null;
        };

        const LIFF_ID = getMeta('liff-id');
        const API_ENDPOINT = getMeta('api-endpoint');

        // 嚴格檢查是否注入成功
        if (!LIFF_ID || LIFF_ID.includes('%')) {
            document.body.innerHTML = `
                <div style="padding:20px; text-align:center; font-family:sans-serif;">
                    <h2>系統設定錯誤</h2>
                    <p>LIFF_ID 未正確載入</p>
                    <p style="color:#666; font-size:14px;">請聯絡管理員檢查 Vercel 環境變數：<br><code>NEXT_PUBLIC_LIFF_ID</code></p>
                </div>`;
            throw new Error('LIFF_ID not injected');
        }

        if (!API_ENDPOINT || API_ENDPOINT.includes('%')) {
            document.body.innerHTML = `
                <div style="padding:20px; text-align:center; font-family:sans-serif;">
                    <h2>系統設定錯誤</h2>
                    <p>API 端點未正確載入</p>
                    <p style="color:#666; font-size:14px;">請聯絡管理員檢查 Vercel 環境變數：<br><code>NEXT_PUBLIC_API_ENDPOINT</code></p>
                </div>`;
            throw new Error('API_ENDPOINT not injected');
        }

        const DELIVERY_FEE = 30;

        // === 以下其餘程式碼不變 ===
        const DEFAULT_MENU = [ /* ... */ ];

        const apiService = { /* ... */ };
        const useLiff = () => { /* ... */ };
        // ... 其餘組件不變 ...

        // 主應用
        const App = () => { /* ... */ };
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
